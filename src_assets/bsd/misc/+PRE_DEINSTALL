#!/bin/sh

# FreeBSD post-deinstall script for Sunshine
# This script cleans up configuration added during installation

echo "Cleaning up Sunshine configuration..."

# Remove devfs rules
DEVFS_RULESET_FILE="/etc/devfs.rules"
if [ -f "$DEVFS_RULESET_FILE" ]; then
  if grep -q "# Sunshine virtual input device rules" "$DEVFS_RULESET_FILE"; then
    echo "Removing devfs rules from $DEVFS_RULESET_FILE..."
    # Create a temporary file without the Sunshine rules
    sed '/# Sunshine virtual input device rules/,/^$/d' "$DEVFS_RULESET_FILE" > "$DEVFS_RULESET_FILE.tmp"
    mv "$DEVFS_RULESET_FILE.tmp" "$DEVFS_RULESET_FILE"
    echo "Devfs rules removed."
  fi
fi

# Note: We intentionally do NOT:
# - Remove the 'input' group (other software may use it)

echo "Cleanup complete."
echo ""
echo "Note: The 'input' group has not been removed as other software may use it."
echo "If you wish to remove it manually, run: pw groupdel input"
echo ""
